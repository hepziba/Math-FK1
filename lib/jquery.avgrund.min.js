(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?module.exports=n:n(jQuery)})(function(n){n.fn.avgrund=function(t){return t=n.extend({width:380,height:280,showClose:!1,showCloseText:"",closeByEscape:!0,closeByDocument:!0,holderClass:"",overlayClass:"",enableStackAnimation:!1,onBlurContainer:"",openOnEvent:!0,setEvent:"click",onLoad:!1,onUnload:!1,onClosing:!1,template:"<p>This is test popin content!<\/p>"},t),this.each(function(){function o(n){t.closeByEscape&&n.keyCode===27&&u()}function s(i){t.closeByDocument?n(i.target).is(".avgrund-overlay, .avgrund-close")&&(i.preventDefault(),u()):n(i.target).is(".avgrund-close")&&(i.preventDefault(),u())}function h(){if(typeof t.onLoad=="function")t.onLoad(r);setTimeout(function(){i.addClass("avgrund-active")},100);var u=n('<div class="avgrund-popin '+t.holderClass+'"><\/div>');u.append(c);i.append(u);n(".avgrund-popin").css({width:f+"px",height:e+"px","margin-left":"-"+(f/2+10)+"px","margin-top":"-"+(e/2+10)+"px"});t.showClose&&n(".avgrund-popin").append('<a href="#" class="avgrund-close">'+t.showCloseText+"<\/a>");t.enableStackAnimation&&n(".avgrund-popin").addClass("stack");i.bind("keyup",o).bind("click",s)}function u(){if(typeof t.onClosing=="function"&&t.onClosing(r)===!1)return!1;if(i.unbind("keyup",o).unbind("click",s).removeClass("avgrund-active"),setTimeout(function(){n(".avgrund-popin").remove()},500),typeof t.onUnload=="function")t.onUnload(r)}var r=n(this),i=n("body"),f=t.width>640?640:t.width,e=t.height>350?350:t.height,c=typeof t.template=="function"?t.template(r):t.template;i.addClass("avgrund-ready");n(".avgrund-overlay").length===0&&i.append('<div class="avgrund-overlay '+t.overlayClass+'"><\/div>');t.onBlurContainer!==""&&n(t.onBlurContainer).addClass("avgrund-blur");t.openOnEvent?r.bind(t.setEvent,function(t){t.stopPropagation();n(t.target).is("a")&&t.preventDefault();h()}):h()})}});